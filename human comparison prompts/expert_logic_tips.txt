

def expert_logic_tips_prompt(nmr_data, formula=None):
    """Chain of thought prompt with both expert and logic tips"""
    return f"""
            Here is 1H and 13C NMR spectrum data for a certain molecule {":" if formula is None else f"with chemical formula {formula}:"}
            {nmr_data} 
            Let's think step-by-step using both logical analysis and expert knowledge.
            
            Use a scratchpad to:
            1. Identify all peak groups in the 1H and 13C NMR spectra and assign them to their corresponding hydrogens and carbons.
            2. Ensure stoichiometry matches the formula
            3. For each peak group, hypothesize possible molecular fragments
            4. Rank hypotheses by plausibility
            5. Build candidate molecules from fragments
            
            Consider these expert guidelines:
            - Check if the molecule is fully saturated or has multiple bonds/rings
            - Look for exchangeable hydrogens based on solvent
            - Note typical 1H NMR chemical shift regions:
              * 10-13 ppm: carboxylic acids
              * 9-11 ppm: aldehydes
              * 6.5-8 ppm: aromatic hydrogens
              * 4-7.5 ppm: alkene hydrogens
              * 3-5 ppm: O-CH fragments
              * 2-3.5 ppm: alkyne hydrogens
              * 0.5-2.5 ppm: alkyl hydrogens
            
            - Note typical 13C NMR chemical shift regions:
              * 190-220 ppm: carbonyl carbons (ketones, aldehydes)
              * 160-180 ppm: carboxylic acid derivatives
              * 110-160 ppm: aromatic and alkene carbons
              * 50-90 ppm: carbons with electronegative substituents
              * 0-50 ppm: alkyl carbons
              
            - For 13C NMR interpretation:
              * Each signal corresponds to a non-equivalent carbon atom
              * In APT spectra, positive (up) signals are CH₂ and quaternary carbons
              * In APT spectra, negative (down) signals are CH₃ and CH carbons
              * All carbon signals typically appear as singlets due to decoupling
            
            {"" if formula is None else "Be mindful of stoichiometry and ensure consistency with the given formula." }
            Format the final answer like this - 
            ### Scratchpad ### <scratchpad> ### Scratchpad ###
            ### Start answer ### <prediction> ### End answer ###
            The prediction should only contain the name of the molecule and no other text
        """